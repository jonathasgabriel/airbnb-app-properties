{"ast":null,"code":"var _jsxFileName = \"/Users/jgdharb/DevProjects/rocketSeat/airBnb/airbnb-web/src/pages/app/index.js\";\nimport React, { Component, Fragment } from \"react\";\nimport Dimensions from \"react-dimensions\";\nimport MapGL from \"react-map-gl\";\nimport PropTypes from \"prop-types\";\nimport { ModalRoute } from \"react-router-modal\";\nimport { withRouter } from \"react-router-dom\";\nimport debounce from \"lodash/debounce\";\nimport { logout } from \"../../services/auth\";\nimport api from \"../../services/api\";\nimport Property from \"../Property\";\nimport AddProperty from \"../addProperty\";\nimport Properties from \"./components/properties\";\nimport Button from \"./components/button\";\nimport { Container, ButtonContainer, PointReference } from \"./styles\";\nconst TOKEN = \"pk.eyJ1IjoiamdkaGFyYiIsImEiOiJjazBndms4d24wODd2M25tb2Jvb2JpaXMwIn0.N25OQLFPatXAIb_jgQ06zQ\";\n\nclass Map extends Component {\n  constructor() {\n    super();\n    this.state = {\n      viewport: {\n        latitude: -27.2108001,\n        longitude: -49.6446024,\n        zoom: 12.8,\n        bearing: 0,\n        pitch: 0\n      },\n      properties: [],\n      addActivate: false\n    };\n\n    this.loadProperties = async () => {\n      const _this$state$viewport = this.state.viewport,\n            latitude = _this$state$viewport.latitude,\n            longitude = _this$state$viewport.longitude;\n\n      try {\n        const response = await api.get(\"/properties\", {\n          params: {\n            latitude,\n            longitude\n          }\n        });\n        console.log(response.data);\n        response.data.forEach(element => {\n          element.longitude = Number(element.longitude);\n          element.latitude = Number(element.latitude);\n          element.price = Number(element.price);\n        });\n        console.log(response.data);\n        this.setState({\n          properties: response.data\n        });\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.handleLogout = e => {\n      logout();\n      this.props.history.push(\"/\");\n    };\n\n    this.handleAddProperty = () => {\n      const _this$props = this.props,\n            match = _this$props.match,\n            history = _this$props.history;\n      const _this$state$viewport2 = this.state.viewport,\n            latitude = _this$state$viewport2.latitude,\n            longitude = _this$state$viewport2.longitude;\n      history.push(\"\".concat(match.url, \"/properties/add?latitude=\").concat(latitude, \"&longitude=\").concat(longitude));\n      this.setState({\n        addActivate: false\n      });\n    };\n\n    this.updatePropertiesLocalization = debounce(this.updatePropertiesLocalization, 500);\n  }\n\n  componentDidMount() {\n    this.loadProperties();\n  }\n\n  updatePropertiesLocalization() {\n    this.loadProperties();\n  }\n\n  renderActions() {\n    return React.createElement(ButtonContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"#fc6963\",\n      onClick: () => this.setState({\n        addActivate: true\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    })), React.createElement(Button, {\n      color: \"#222\",\n      onClick: this.handleLogout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-times\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    })));\n  }\n\n  renderButtonAdd() {\n    return this.state.addActivate && React.createElement(PointReference, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-map-marker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.handleAddProperty,\n      type: \"button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"Adicionar\"), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        addActivate: false\n      }),\n      className: \"cancel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"Cancelar\")));\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          width = _this$props2.containerWidth,\n          height = _this$props2.containerHeight,\n          match = _this$props2.match;\n    const _this$state = this.state,\n          properties = _this$state.properties,\n          addActivate = _this$state.addActivate;\n    return React.createElement(Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(MapGL, Object.assign({\n      width: width,\n      height: height\n    }, this.state.viewport, {\n      mapStyle: \"mapbox://styles/mapbox/dark-v9\",\n      mapboxApiAccessToken: TOKEN,\n      onViewportChange: viewport => this.setState({\n        viewport\n      }),\n      onViewStateChange: this.updatePropertiesLocalization.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), !addActivate && React.createElement(Properties, {\n      match: match,\n      properties: properties,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })), this.renderActions(), this.renderButtonAdd(), React.createElement(ModalRoute, {\n      path: \"\".concat(match.url, \"/properties/add\"),\n      parentPath: match.url,\n      component: AddProperty,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), React.createElement(ModalRoute, {\n      path: \"\".concat(match.url, \"/property/:id\"),\n      parentPath: match.url,\n      component: Property,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }));\n  }\n\n}\n\nMap.propTypes = {\n  containerWidth: PropTypes.number.isRequired,\n  containerHeight: PropTypes.number.isRequired\n};\nconst DimensionedMap = withRouter(Dimensions()(Map));\n\nconst App = () => React.createElement(Container, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 165\n  },\n  __self: this\n}, React.createElement(DimensionedMap, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 166\n  },\n  __self: this\n}));\n\nexport default App;","map":{"version":3,"sources":["/Users/jgdharb/DevProjects/rocketSeat/airBnb/airbnb-web/src/pages/app/index.js"],"names":["React","Component","Fragment","Dimensions","MapGL","PropTypes","ModalRoute","withRouter","debounce","logout","api","Property","AddProperty","Properties","Button","Container","ButtonContainer","PointReference","TOKEN","Map","constructor","state","viewport","latitude","longitude","zoom","bearing","pitch","properties","addActivate","loadProperties","response","get","params","console","log","data","forEach","element","Number","price","setState","err","handleLogout","e","props","history","push","handleAddProperty","match","url","updatePropertiesLocalization","componentDidMount","renderActions","renderButtonAdd","render","width","containerWidth","height","containerHeight","bind","propTypes","number","isRequired","DimensionedMap","App"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport Dimensions from \"react-dimensions\";\nimport MapGL from \"react-map-gl\";\nimport PropTypes from \"prop-types\";\nimport { ModalRoute } from \"react-router-modal\";\nimport { withRouter } from \"react-router-dom\";\n\nimport debounce from \"lodash/debounce\";\n\nimport { logout } from \"../../services/auth\";\nimport api from \"../../services/api\";\nimport Property from \"../Property\";\nimport AddProperty from \"../addProperty\";\nimport Properties from \"./components/properties\";\nimport Button from \"./components/button\";\n\nimport { Container, ButtonContainer, PointReference } from \"./styles\";\n\nconst TOKEN =\n  \"pk.eyJ1IjoiamdkaGFyYiIsImEiOiJjazBndms4d24wODd2M25tb2Jvb2JpaXMwIn0.N25OQLFPatXAIb_jgQ06zQ\";\n\nclass Map extends Component {\n\n  constructor() {\n    super();\n    this.updatePropertiesLocalization = debounce(\n      this.updatePropertiesLocalization,\n      500\n    );\n  }\n\n  static propTypes = {\n    containerWidth: PropTypes.number.isRequired,\n    containerHeight: PropTypes.number.isRequired\n  };\n\n  state = {\n    viewport: {\n      latitude: -27.2108001,\n      longitude: -49.6446024,\n      zoom: 12.8,\n      bearing: 0,\n      pitch: 0\n    },\n    properties: [],\n    addActivate: false\n  };\n\n  componentDidMount() {\n    this.loadProperties();\n  }\n  \n  updatePropertiesLocalization() {\n    this.loadProperties();\n  }\n  \n  loadProperties = async () => {\n    const { latitude, longitude } = this.state.viewport;\n    try {\n      const response = await api.get(\"/properties\", {\n        params: { latitude, longitude }\n      });\n\n      console.log(response.data);\n      response.data.forEach(element => {\n        element.longitude = Number(element.longitude);\n        element.latitude = Number(element.latitude);\n        element.price = Number(element.price);\n      });\n      console.log(response.data);\n      this.setState({ properties: response.data });\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  handleLogout = e => {\n    logout();\n    this.props.history.push(\"/\");\n  };\n\n  handleAddProperty = () => {\n    const { match, history } = this.props;\n    const { latitude, longitude } = this.state.viewport;\n    history.push(\n      `${match.url}/properties/add?latitude=${latitude}&longitude=${longitude}`\n    );\n    \n    this.setState({ addActivate: false });\n  };\n\n  renderActions() {\n    return (\n      <ButtonContainer>\n        <Button\n          color=\"#fc6963\"\n          onClick={() => this.setState({ addActivate: true })}\n        >\n          <i className=\"fa fa-plus\" />\n        </Button>\n        <Button color=\"#222\" onClick={this.handleLogout}>\n          <i className=\"fa fa-times\" />\n        </Button>\n      </ButtonContainer>\n    );\n  }\n\n  renderButtonAdd() {\n    return (\n      this.state.addActivate && (\n        <PointReference>\n          <i className=\"fa fa-map-marker\" />\n          <div>\n            <button onClick={this.handleAddProperty} type=\"button\">\n              Adicionar\n            </button>\n            <button\n              onClick={() => this.setState({ addActivate: false })}\n              className=\"cancel\"\n            >\n              Cancelar\n            </button>\n          </div>\n        </PointReference>\n      )\n    );\n  }\n\n  render() {\n    const { containerWidth: width, containerHeight: height, match } = this.props;\n    const { properties, addActivate } = this.state;\n    return (\n      <Fragment>\n        <MapGL\n          width={width}\n          height={height}\n          {...this.state.viewport}\n          mapStyle=\"mapbox://styles/mapbox/dark-v9\"\n          mapboxApiAccessToken={TOKEN}\n          onViewportChange={viewport => this.setState({ viewport })}\n          onViewStateChange={this.updatePropertiesLocalization.bind(this)}\n        >\n          {!addActivate && <Properties match={match} properties={properties} />}\n        </MapGL>\n        {this.renderActions()}\n        {this.renderButtonAdd()}\n        <ModalRoute\n          path={`${match.url}/properties/add`}\n          parentPath={match.url}\n          component={AddProperty}\n        />\n        <ModalRoute\n          path={`${match.url}/property/:id`}\n          parentPath={match.url}\n          component={Property}\n        />\n      </Fragment>\n    );\n  }\n}\n\nconst DimensionedMap = withRouter(Dimensions()(Map));\n\nconst App = () => (\n  <Container>\n    <DimensionedMap />\n  </Container>\n);\n\nexport default App;"]},"metadata":{},"sourceType":"module"}